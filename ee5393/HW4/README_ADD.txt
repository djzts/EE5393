The original uploaded version use bitsrl function in line 139 seems like does not supported in 2016a. 
I change it to bitshift in this newer version. 
